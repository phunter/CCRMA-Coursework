% Music 421a
% Lab 1
% Problem 2

% Blackman window
N = 1024; % window length
w = (.42 - .5*cos(2*pi*(0:N-1)/(N-1)) + .08*cos(4*pi*(0:N-1)/(N-1)))';

freq = 1000;
sr = 8192;
sinusoid = .6 * cos( ((freq * (2 * pi) / sr) * 0:(N-1)) + .25*2*pi);

wSinusBlackman = sinusoid .* w';

wTr = fft(wSinusBlackm, 4 * N);

figure;

subplot(811);
plot(w);

subplot(812);
plot(sinusoid);

subplot(813);
plot(wSinus);

subplot(814);
plot([0 : 2*pi/(N*4) : 2*pi*(1-1/(N*4))] - pi, 20*log10(abs(wTr)/max(abs(wTr))));
grid;
